{% extends "base.html" %}

{% block content %}

<div class="cloud">
	<h3>Zadanie {{ problem.id }}.</h3>

	<a href="{% url 'problems:index' %}" class="mdl-button mdl-js-button mdl-button--raised">Powrót</a>

	{% if user.is_staff %}
	<a href="{% url 'problems:edit' problem.id %}" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">Edytuj</a>

	<button id="show-delete-delete" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">Usuń</button>
	{% endif %}

	{% if problem.answer and not show_answer %}
	<button id="show-delete-answer" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">Odpowiedź</button>
	{% endif %}

	{% if problem.hints and not show_hints %}
	<button id="show-delete-hints" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">Wskazówka</button>
	{% endif %}

	{% if problem.solution and not show_solution %}
	<button id="show-delete-solution" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">Rozwiązanie</button>
	{% endif %}

	<form action="{% url 'problems:claim' problem.id %}", method="post", style="display: inline;">
		{% csrf_token %}
		<button type="submit" class="mdl-button mdl-js-button mdl-button--raised">
			{% if solved_task %}Zmień na niezrobione{% else %}Zmień na zrobione{% endif %}
		</a>
	</form>
</div>

<div class="problem-cloud {% if solved_task %}green-background{% endif %}">
	<p><big>Treść: </big>{{ problem.statement }}</p>
	{% if user.is_staff %}
	<div class="chip-container">
	{% for tag in tags %}
		<span class="mdl-chip">
			<span class="category-chip category-color-{{ tag.type_id }}"></span>
			<span class="mdl-chip__text">{{ tag.name }}</span>
		</span>
	{% endfor %}
	</div>
	{% endif %}
</div>

{% if show_answer %}
<div class="problem-cloud">
	<p><big>Odpowiedź: </big>{{ problem.answer }}</p>
</div>
{% endif %}

{% if show_hints %}
<div class="problem-cloud">
	<p><big>Wskazówka: </big>{{ problem.hints }}</p>
</div>

{% endif %}

{% if show_solution %}
<div class="problem-cloud">
	<p><big>Rozwiązanie: </big>{{ problem.solution }}</p>
</div>
{% endif %}

{% if problem.answer and not show_answer %}
<dialog class="mdl-dialog" id="dialog-answer" width=100>
	<h5 class>Czy na pewno chcesz zobaczyć odpowiedź?</h5>
	<div class="mdl-dialog__content">
	</div>
	<div class="mdl-dialog__actions">
		<a href="{% url 'problems:details' problem.id %}?show_answer=True" class="mdl-button">Tak :(</a>
		<button type="button" class="mdl-button close">Anuluj</button>
	</div>
</dialog>
<script>activate_dialog('answer');</script>
{% endif %}

{% if problem.hints and not show_hints %}
<dialog class="mdl-dialog" id="dialog-hints" width=100>
	<h5 class>Czy na pewno chcesz zobaczyć wskazówkę?</h5>
	<div class="mdl-dialog__content">
	</div>
	<div class="mdl-dialog__actions">
		<a href="{% url 'problems:details' problem.id %}?show_hints=True" class="mdl-button">Tak :(</a>
		<button type="button" class="mdl-button close">Anuluj</button>
	</div>
</dialog>
<script>activate_dialog('hints');</script>
{% endif %}

{% if problem.solution and not show_solution %}
<dialog class="mdl-dialog" id="dialog-solution" width=100>
	<h5 class>Czy na pewno chcesz zobaczyć rozwiązanie?</h5>
	<div class="mdl-dialog__content">
	</div>
	<div class="mdl-dialog__actions">
		<a href="{% url 'problems:details' problem.id %}?show_solution=True" class="mdl-button">Tak :(</a>
		<button type="button" class="mdl-button close">Anuluj</button>
	</div>
</dialog>
<script>activate_dialog('solution');</script>
{% endif %}

{% if user.is_staff %}
<form action="{% url 'problems:delete' problem.id %}" method="post" id="delete_form">
{% csrf_token %}
</form>

<dialog class="mdl-dialog" id="dialog-delete" width=100>
	<h5 class>Czy chcesz usunąć zadanie?</h5>
	<div class="mdl-dialog__content">
	</div>
	<div class="mdl-dialog__actions">
		<button form="delete_form" type="submit" class="mdl-button">Usuń</button>
		<button type="button" class="mdl-button close">Anuluj</button>
	</div>
</dialog>

<script>activate_dialog('delete');</script>
{% endif %}

{% endblock %}
